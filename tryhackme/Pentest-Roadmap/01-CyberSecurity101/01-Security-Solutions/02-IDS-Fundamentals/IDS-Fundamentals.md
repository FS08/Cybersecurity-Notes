# IDS Fundamentals

## What this is
An **Intrusion Detection System (IDS)** monitors internal traffic (using signature and anomaly detection) and alerts administrators to suspicious activity, without blocking it.


## IDS Categories
IDSs are commonly categorized by deployment and detection mode.

### Deployment Modes
- **Host-based (HIDS):** installed on individual hosts to monitor system-level activity and logs. Good visibility per host but harder to manage at scale.
- **Network-based (NIDS):** monitors network traffic across hosts from a centralized point; useful for broad visibility of network-level threats.

### Detection Modes
- **Signature-based:** matches known attack patterns (fast and accurate for known threats; cannot detect zero-days).
- **Anomaly-based:** learns a baseline and flags deviations (can detect novel attacks but may produce false positives).
- **Hybrid:** combines signature and anomaly techniques to leverage both approaches.

### Comparison Summary
| Category | Scope | Strength | Weakness |
|---|---|---|---|
| HIDS | Single host | Detailed host activity, file/process monitoring | Management overhead on many hosts |
| NIDS | Network-wide | Centralized visibility of traffic | Blind to encrypted payloads or host internals |
| Signature-based | N/A | Accurate for known threats | Misses zero-day attacks |
| Anomaly-based | N/A | Can detect unknown attacks | Higher false positives, tuning required |

### Choosing and Tuning
- Use NIDS for network-level visibility and HIDS for critical hosts.  
- Prefer hybrid systems in environments needing both known-threat coverage and zero-day detection.  
- Tune anomaly systems and keep signature feeds updated to reduce false positives and blind spots.

## Snort
Snort is a widely used open-source IDS that ships with built-in signature rules and supports custom rules for specific detections. It can run in lightweight packet-sniffing or logging modes, but its primary IDS capability is delivered in NIDS mode where it applies rule files to detect and alert on known attack patterns.

### Snort Modes (compact)
| Mode | What it does | When to use |
|---|---|---|
| Packet sniffer | Reads and displays packets (no analysis) | Quick troubleshooting and traffic inspection |
| Packet logging | Captures traffic to PCAPs and logs detections | Forensic analysis and evidence collection |
| NIDS mode | Applies rule files in real time and generates alerts | Production IDS monitoring (primary use) |

Snort lets you enable/disable built-in rules and add custom rules to tailor detections; we will explore its rule files and custom rule creation in the upcoming task.

## Snort — Quick Start
A few practical notes to get Snort running for detection and testing.

- **Interface & capture mode:** specify the network interface and monitored range in `snort.conf`. Enable promiscuous mode on the interface if you want Snort to capture traffic for the whole network (not just the host).

- **Key files (default location):** Snort stores configuration and rules under `/etc/snort` (notably `snort.conf` and the `rules/` directory). Example files you will see:

```
/etc/snort:
	snort.conf  rules/  classification.config  reference.config  threshold.conf
```

- **Rule format (short):**
	action proto src_ip src_port -> dst_ip dst_port (options)

- **Common options:** `msg` (alert text), `sid` (unique ID), `rev` (revision), plus many others for content, flags, and metadata.

- **Example rule (add to `/etc/snort/rules/local.rules`):**

```
alert icmp any any -> 127.0.0.1 any (msg:"Loopback Ping Detected"; sid:10003; rev:1;)
```

- **Edit local rules:**
	`sudo nano /etc/snort/rules/local.rules` — add your custom rules, save and exit.

- **Run Snort for live detection (console output):**
	`sudo snort -q -l /var/log/snort -i lo -A console -c /etc/snort/snort.conf`
	(replace `lo` with your interface name)

- **Run Snort on a PCAP file:**
	`sudo snort -q -l /var/log/snort -r Task.pcap -A console -c /etc/snort/snort.conf`

These commands show alerts on the console and log to `/var/log/snort`. We will use these in the upcoming lab to test built-in and custom rules.

